{
  "label": "POST /export",
  "captured_at": "2026-01-22T00:33:34Z",
  "preview": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Viewer</title>\n\n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n\n    <!-- Custom CSS -->\n    <link href=\"/static/custom.css\" rel=\"stylesheet\">\n\n    <!-- Font Awesome for icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n</head>\n<body>\n    <!-- Navigation -->\n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n        <div class=\"container\">\n            <div class=\"viewer-menu dropdown\">\n                <div class=\"btn-group viewer-menu-group\" role=\"group\">\n                    <a class=\"navbar-brand fw-bold viewer-menu-home\" href=\"/\">\n                        <i class=\"fas fa-shield-alt me-2\"></i>Viewer\n                    </a>\n                    <button\n                        class=\"btn btn-link dropdown-toggle dropdown-toggle-split viewer-menu-toggle\"\n                        type=\"button\"\n                        id=\"viewerMenuToggle\"\n                        data-bs-t",
  "request": {
    "method": "POST",
    "path": "/export?",
    "url": "http://localhost/export",
    "headers": [
      {
        "name": "User-Agent",
        "value": "Werkzeug/3.1.5"
      },
      {
        "name": "Host",
        "value": "localhost"
      },
      {
        "name": "Content-Type",
        "value": "application/x-www-form-urlencoded"
      },
      {
        "name": "Content-Length",
        "value": "47"
      }
    ],
    "query": {},
    "body": null
  },
  "response": {
    "status_code": 200,
    "mimetype": "text/html",
    "headers": [
      {
        "name": "Content-Type",
        "value": "text/html; charset=utf-8"
      },
      {
        "name": "Content-Length",
        "value": "54384"
      },
      {
        "name": "Vary",
        "value": "Cookie"
      },
      {
        "name": "Set-Cookie",
        "value": "session=eyJfcGVybWFuZW50Ijp0cnVlfQ.aXFwXg.wxXuCJB7WPq4QdzwNjT6M_IzbMw; Expires=Sun, 22 Feb 2026 00:33:34 GMT; HttpOnly; Path=/"
      }
    ],
    "body": {
      "encoding": "utf-8",
      "text": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Viewer</title>\n    \n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n\n    <!-- Custom CSS -->\n    <link href=\"/static/custom.css\" rel=\"stylesheet\">\n\n    <!-- Font Awesome for icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n</head>\n<body>\n    <!-- Navigation -->\n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n        <div class=\"container\">\n            <div class=\"viewer-menu dropdown\">\n                <div class=\"btn-group viewer-menu-group\" role=\"group\">\n                    <a class=\"navbar-brand fw-bold viewer-menu-home\" href=\"/\">\n                        <i class=\"fas fa-shield-alt me-2\"></i>Viewer\n                    </a>\n                    <button\n                        class=\"btn btn-link dropdown-toggle dropdown-toggle-split viewer-menu-toggle\"\n                        type=\"button\"\n                        id=\"viewerMenuToggle\"\n                        data-bs-toggle=\"dropdown\"\n                        data-bs-auto-close=\"outside\"\n                        aria-expanded=\"false\"\n                        aria-label=\"Open Viewer navigation menu\"\n                    ></button>\n                    <ul class=\"dropdown-menu shadow\" aria-labelledby=\"viewerMenuToggle\" data-viewer-menu>\n                        <li class=\"dropdown-header text-uppercase small text-muted\">Workspace</li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/uploads\">\n                                <i class=\"fas fa-upload text-muted\"></i>\n                                <span>Uploads</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/server_events\">\n                                <i class=\"fas fa-server text-muted\"></i>\n                                <span>Server Events</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/history\">\n                                <i class=\"fas fa-history text-muted\"></i>\n                                <span>History</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/export\">\n                                <i class=\"fas fa-download text-muted\"></i>\n                                <span>Export Data</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/import\">\n                                <i class=\"fas fa-file-import text-muted\"></i>\n                                <span>Import Data</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/openapi\">\n                                <i class=\"fas fa-book text-muted\"></i>\n                                <span>API Docs</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/help\">\n                                <i class=\"fas fa-circle-question text-muted\"></i>\n                                <span>Help</span>\n                            </a>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-link text-muted\"></i>\n                                <span>Aliases</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-aliases>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/aliases\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All aliases</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/aliases/CSS\">CSS</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/aliases/ai\">ai</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/aliases/cookies\">cookies</a>\n                                            \n                                        </li>\n                                    \n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-server text-muted\"></i>\n                                <span>Servers</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-servers>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/servers\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All servers</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/ai_editor\">ai_editor</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/ai_stub\">ai_stub</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/shared-tool\">shared-tool</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/urleditor\">urleditor</a>\n                                            \n                                        </li>\n                                    \n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-code text-muted\"></i>\n                                <span>Variables</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-variables>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/variables\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All variables</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    <li>\n                                        <span class=\"dropdown-item-text text-muted small\">No variables yet</span>\n                                    </li>\n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-key text-muted\"></i>\n                                <span>Secrets</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-secrets>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/secrets\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All secrets</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    <li>\n                                        <span class=\"dropdown-item-text text-muted small\">No secrets yet</span>\n                                    </li>\n                                \n                            </ul>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/routes\">\n                                <i class=\"fas fa-diagram-project text-muted\"></i>\n                                <span>Routes</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/source\">\n                                <i class=\"fas fa-file-code text-muted\"></i>\n                                <span>Source</span>\n                            </a>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li class=\"dropdown-header text-uppercase small text-muted\">Account</li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/profile\">\n                                <i class=\"fas fa-id-badge text-muted\"></i>\n                                <span>Profile</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/settings\">\n                                <i class=\"fas fa-sliders-h text-muted\"></i>\n                                <span>Settings</span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\">\n                <span class=\"navbar-toggler-icon\"></span>\n            </button>\n\n            <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n                <ul class=\"navbar-nav me-auto align-items-lg-center\">\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/search\">\n                            <i class=\"fas fa-magnifying-glass me-1\"></i>Search\n                        </a>\n                    </li>\n                </ul>\n\n                <ul class=\"navbar-nav align-items-center\">\n                    <li class=\"nav-item dropdown\">\n                        <a\n                            class=\"nav-link text-light dropdown-toggle d-flex align-items-center\"\n                            href=\"#\"\n                            id=\"pageInfoMenu\"\n                            role=\"button\"\n                            data-bs-toggle=\"dropdown\"\n                            aria-expanded=\"false\"\n                            title=\"Page information and logs\"\n                            aria-label=\"Page information and logs\"\n                        >\n                            <i class=\"fas fa-circle-info\"></i>\n                        </a>\n                        <ul class=\"dropdown-menu dropdown-menu-end\" aria-labelledby=\"pageInfoMenu\">\n                            <li>\n                                <a class=\"dropdown-item\" href=\"/help\">\n                                    <i class=\"fas fa-circle-question me-2\"></i>Help\n                                </a>\n                            </li>\n                            <li><hr class=\"dropdown-divider\"></li>\n                            <li>\n                                <a class=\"dropdown-item\" href=\"/meta/export.html\">\n                                    About this page\n                                </a>\n                            </li>\n                            <li>\n                                <a class=\"dropdown-item\" href=\"/history?start=\">\n                                    History\n                                </a>\n                            </li>\n                            <li>\n                                <a class=\"dropdown-item\" href=\"/server_events?start=\">\n                                    Server Events\n                                </a>\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <!-- Flash Messages -->\n    \n        \n    \n\n    <!-- Main Content -->\n    <main class=\"py-4\">\n        \n<div class=\"container\">\n    <div class=\"row justify-content-center\">\n        <div class=\"col-lg-8\">\n            <div class=\"card border-primary shadow-sm\" data-export-cid=\"AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA\">\n                <div class=\"card-header bg-primary text-white\">\n                    <h4 class=\"card-title mb-0\">\n                        <i class=\"fas fa-download me-2\"></i>Your export is ready\n                    </h4>\n                </div>\n                <div class=\"card-body\">\n                    <p class=\"lead\">The selected data has been saved as a CID-backed JSON file.</p>\n\n                    <div class=\"mb-4\">\n                        <h5 class=\"mb-2\">Export CID</h5>\n                        <div class=\"bg-light p-3 rounded border\">\n                            \n<span class=\"cid-display dropdown\">\n    <a class=\"cid-link\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.txt\" title=\"AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA\">#AAAAAGSlZ...</a>\n    <button\n        type=\"button\"\n        class=\"btn btn-sm btn-outline-secondary cid-menu-btn dropdown-toggle\"\n        data-bs-toggle=\"dropdown\"\n        data-bs-boundary=\"viewport\"\n        data-bs-offset=\"0,8\"\n        aria-expanded=\"false\"\n        aria-haspopup=\"true\"\n        aria-label=\"More options for CID AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA\"\n    >\n        <i class=\"fas fa-ellipsis-vertical\"></i>\n    </button>\n    <ul class=\"dropdown-menu dropdown-menu-end\">\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.txt\"><i class=\"fas fa-file-alt text-muted me-2\"></i>View as text</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.md\"><i class=\"fas fa-file-code text-muted me-2\"></i>View as markdown</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.html\"><i class=\"fas fa-file-code text-muted me-2\"></i>View as HTML</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.json\"><i class=\"fas fa-code text-muted me-2\"></i>View as JSON</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.png\"><i class=\"fas fa-file-image text-muted me-2\"></i>View as PNG</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.jpg\"><i class=\"fas fa-file-image text-muted me-2\"></i>View as JPG</a></li>\n        <li><a class=\"dropdown-item\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.qr\"><i class=\"fas fa-qrcode text-muted me-2\"></i>View as QR</a></li>\n        <li><a class=\"dropdown-item\" href=\"/edit/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA\"><i class=\"fas fa-edit text-muted me-2\"></i>Edit</a></li>\n        <li><a class=\"dropdown-item\" href=\"/meta/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA\"><i class=\"fas fa-circle-info text-muted me-2\"></i>View metadata</a></li>\n        <li><hr class=\"dropdown-divider\"></li>\n        <li>\n            <button type=\"button\" class=\"dropdown-item cid-copy-action\" data-copy-path=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.txt\">\n                <i class=\"fas fa-copy text-muted me-2\"></i>Copy link\n            </button>\n        </li>\n    </ul>\n</span>\n\n                        </div>\n                    </div>\n\n                    <div class=\"alert alert-info\" role=\"alert\">\n                        <div class=\"d-flex flex-column flex-md-row align-items-md-center gap-2\">\n                            <div><i class=\"fas fa-link me-2\"></i>Download link:</div>\n                            <div class=\"input-group\">\n                                <input type=\"text\" class=\"form-control\" value=\"http://localhost/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.json\" readonly>\n                                <a class=\"btn btn-primary\" href=\"/AAAAAGSlZTC5B_zTisahES5kdhVy3PpiJonJacpYgrE72esI0jeRfbYLK8qjOebhjuGOALQiWHQFuEjRmHcSChmWpVICZA.json\" target=\"_blank\" rel=\"noopener\">Download JSON</a>\n                            </div>\n                        </div>\n                    </div>\n\n                    \n\n                    <details class=\"mt-3\">\n                        <summary class=\"fw-semibold\">View exported JSON</summary>\n                        <pre class=\"mt-3 bg-dark text-light p-3 rounded\" style=\"max-height: 24rem; overflow:auto;\">{\n  &#34;project_files&#34;: &#34;AAAAAAESWBVJ-Q2FIfq060eQN4c4Hr9s-zEGa0VrnIcX5A0NpFNFRudB8AdfLy2Kjj1hQOCDpFt4LwsA3TW28Ap83ZWLmg&#34;,\n  &#34;runtime&#34;: &#34;AAAAAAus_br9miwuthtyUNjF45mZ4v-vR9kgOB09veR-QoQxujcialqoox-nxx_RaJhd_xyQzeWBdxoL4NJtU78n2EVNBw&#34;,\n  &#34;servers&#34;: &#34;AAAAAAK6P6C-meMZKrJ0BOD-67ays3g5Pxx54DpL9O0rFfnY-nU-5tro2-BT6BQ1SatKoyLFLN6KI8pvkpOfqEj_uBt9lQ&#34;,\n  &#34;version&#34;: 6,\n  &#34;cid_values&#34;: {\n    &#34;AAAAAABE2sNsobun9mOvieq8Ag9QdDHGeJZQU5lezP9E4-PVJFxlSGjrLrwjP401NYAuGDtc6TgIGJjms-wj73hFIz9m4g&#34;: &#34;return {\\&#34;output\\&#34;: \\&#34;Hello from origin\\&#34;, \\&#34;content_type\\&#34;: \\&#34;text/plain\\&#34;}&#34;,\n    &#34;AAAAAAESWBVJ-Q2FIfq060eQN4c4Hr9s-zEGa0VrnIcX5A0NpFNFRudB8AdfLy2Kjj1hQOCDpFt4LwsA3TW28Ap83ZWLmg&#34;: &#34;{\\n  \\&#34;pyproject.toml\\&#34;: {\\n    \\&#34;cid\\&#34;: \\&#34;AAAAAAXhM7zqIRCi7wFbXi_FVqDMXUh-jzWXMidCqtDwHFTzPcd5_m6KQ_oQe4DaZJlak_SjIL4it4jOVUl7q0N_Z0Fsnw\\&#34;\\n  },\\n  \\&#34;requirements.txt\\&#34;: {\\n    \\&#34;cid\\&#34;: \\&#34;AAAAAARyHKl_Z6r09mIrx49TxwXRcxYWaQl90wGF5scIzp64Cgb17VJSdyWMWgvx5pHMU0EWNTTPJbAocV6RPoe-xJet_g\\&#34;\\n  }\\n}&#34;,\n    &#34;AAAAAAK6P6C-meMZKrJ0BOD-67ays3g5Pxx54DpL9O0rFfnY-nU-5tro2-BT6BQ1SatKoyLFLN6KI8pvkpOfqEj_uBt9lQ&#34;: &#34;[\\n  {\\n    \\&#34;definition_cid\\&#34;: \\&#34;AAAAABu84p6w-ViWhc4b9TdoEp1SEUI64NweNaxesM3-N4j6rBnNgzaxAgyYRfe8Wz2qlQVBd1d7FESa2CdecOcfTDdYgQ\\&#34;,\\n    \\&#34;enabled\\&#34;: true,\\n    \\&#34;name\\&#34;: \\&#34;ai_editor\\&#34;\\n  },\\n  {\\n    \\&#34;definition_cid\\&#34;: \\&#34;AAAAAAleiNx9m13dcu5ymJvrmiN8K_gRVo0VWXQlJEUzru26al-s2XyUWxaaQMxoGzejJtK53kRkiQgH5M6zmRW9x8i5Cw\\&#34;,\\n    \\&#34;enabled\\&#34;: true,\\n    \\&#34;name\\&#34;: \\&#34;ai_stub\\&#34;\\n  },\\n  {\\n    \\&#34;definition_cid\\&#34;: \\&#34;AAAAAABE2sNsobun9mOvieq8Ag9QdDHGeJZQU5lezP9E4-PVJFxlSGjrLrwjP401NYAuGDtc6TgIGJjms-wj73hFIz9m4g\\&#34;,\\n    \\&#34;enabled\\&#34;: true,\\n    \\&#34;name\\&#34;: \\&#34;shared-tool\\&#34;\\n  },\\n  {\\n    \\&#34;definition_cid\\&#34;: \\&#34;AAAAABmgyDoiCFgDbvxkYL5a2ibb8Gwu4LDDb8ipfR58MUTg3prlyBee5ch0MxsUKG8jgJDOVOZRXJVNY2yCGqPMsM0hJg\\&#34;,\\n    \\&#34;enabled\\&#34;: true,\\n    \\&#34;name\\&#34;: \\&#34;urleditor\\&#34;\\n  }\\n]&#34;,\n    &#34;AAAAAARyHKl_Z6r09mIrx49TxwXRcxYWaQl90wGF5scIzp64Cgb17VJSdyWMWgvx5pHMU0EWNTTPJbAocV6RPoe-xJet_g&#34;: &#34;email-validator&gt;=2.2.0\\nflask-dance&gt;=7.1.0\\nflask&gt;=3.1.2\\nflask-sqlalchemy&gt;=3.1.1\\ngunicorn&gt;=23.0.0\\npsycopg2-binary&gt;=2.9.10\\nflask-login&gt;=0.6.3\\noauthlib&gt;=3.3.1\\npyjwt&gt;=2.10.1\\nflask-wtf&gt;=1.2.2\\nwtforms&gt;=3.2.1\\nsqlalchemy&gt;=2.0.43\\nwerkzeug&gt;=3.1.3\\npython-dotenv&gt;=1.0.0\\ncoverage&gt;=7.0.0\\npylint&gt;=3.3.1\\npylint-pytest&gt;=1.1.8\\nradon&gt;=6.0.1\\nmypy&gt;=1.13.0\\nrequests&gt;=2.31.0\\nMarkdown&gt;=3.6\\nPygments&gt;=2.17.2\\nqrcode[pil]&gt;=7.4.2\\nglom&gt;=23.3.0\\nhypothesis&gt;=6.124.1\\npytest&gt;=8.2.0\\npytest-testmon&gt;=2.1.0\\npytest-timeout&gt;=2.3.0\\npytest-deadfixtures&gt;=2.2.1\\npytest-html&gt;=4.1.0\\npytest-cov&gt;=4.1.0\\nruff&gt;=0.1.0\\nvulture&gt;=2.0\\npyppeteer&gt;=1.0.2,&lt;2.0.0\\nlogfire[all]\\nlogfire[aiohttp-client]\\nopentelemetry-instrumentation-flask&gt;=0.48b0\\nopentelemetry-instrumentation-sqlalchemy&gt;=0.48b0\\nopentelemetry-api\\nopentelemetry-sdk\\nopentelemetry-instrumentation-botocore\\nopentelemetry-instrumentation-fastapi\\nopentelemetry-instrumentation-httpx\\nopentelemetry-instrumentation-jinja2\\nopentelemetry-instrumentation-requests\\nopentelemetry-instrumentation-sqlalchemy\\nopentelemetry-instrumentation-sqlite3\\nopentelemetry-instrumentation-urllib\\nlangsmith&gt;=0.1.0\\nattrs&gt;=23.0.0\\naiohttp&gt;=3.9.0\\nPyGithub&gt;=2.5.0\\n&#34;,\n    &#34;AAAAAAXhM7zqIRCi7wFbXi_FVqDMXUh-jzWXMidCqtDwHFTzPcd5_m6KQ_oQe4DaZJlak_SjIL4it4jOVUl7q0N_Z0Fsnw&#34;: &#34;[project]\\nname = \\&#34;repl-nix-workspace\\&#34;\\nversion = \\&#34;0.1.0\\&#34;\\ndescription = \\&#34;Add your description here\\&#34;\\nrequires-python = \\&#34;&gt;=3.12\\&#34;\\ndependencies = [\\n    \\&#34;email-validator&gt;=2.2.0\\&#34;,\\n    \\&#34;flask-dance&gt;=7.1.0\\&#34;,\\n    \\&#34;flask&gt;=3.1.2\\&#34;,\\n    \\&#34;flask-sqlalchemy&gt;=3.1.1\\&#34;,\\n    \\&#34;gunicorn&gt;=23.0.0\\&#34;,\\n    \\&#34;psycopg2-binary&gt;=2.9.10\\&#34;,\\n    \\&#34;flask-login&gt;=0.6.3\\&#34;,\\n    \\&#34;oauthlib&gt;=3.3.1\\&#34;,\\n    \\&#34;pyjwt&gt;=2.10.1\\&#34;,\\n    \\&#34;flask-wtf&gt;=1.2.2\\&#34;,\\n    \\&#34;wtforms&gt;=3.2.1\\&#34;,\\n    \\&#34;sqlalchemy&gt;=2.0.43\\&#34;,\\n    \\&#34;werkzeug&gt;=3.1.3\\&#34;,\\n    \\&#34;Markdown&gt;=3.6\\&#34;,\\n    \\&#34;Pygments&gt;=2.17.2\\&#34;,\\n    \\&#34;qrcode[pil]&gt;=7.4.2\\&#34;,\\n    \\&#34;glom&gt;=23.3.0\\&#34;,\\n    \\&#34;hypothesis&gt;=6.124.1\\&#34;,\\n    \\&#34;ruff&gt;=0.1.0\\&#34;,\\n    \\&#34;radon&gt;=6.0.1\\&#34;,\\n    \\&#34;mypy&gt;=1.13.0\\&#34;,\\n    \\&#34;pyppeteer&gt;=1.0.2,&lt;2.0.0\\&#34;,\\n    \\&#34;pytest-testmon&gt;=2.1.0\\&#34;,\\n]\\n\\n[tool.radon]\\n# Analyse the repository root while skipping generated assets, front-end bundles,\\n# and the various acceptance-test harnesses.\\npaths = [\\&#34;.\\&#34;]\\nexclude = [\\n    \\&#34;.git\\&#34;,\\n    \\&#34;.github\\&#34;,\\n    \\&#34;docs\\&#34;,\\n    \\&#34;env\\&#34;,\\n    \\&#34;gauge\\&#34;,\\n    \\&#34;gauge_stub\\&#34;,\\n    \\&#34;node_modules\\&#34;,\\n    \\&#34;static\\&#34;,\\n    \\&#34;step_impl\\&#34;,\\n    \\&#34;templates\\&#34;,\\n    \\&#34;test\\&#34;,\\n    \\&#34;test-gauge\\&#34;,\\n    \\&#34;test-unit\\&#34;,\\n    \\&#34;tests\\&#34;,\\n]\\nignore = [\\&#34;**/__init__.py\\&#34;]\\n# The Radon job fails when any block is graded worse than this rank.  The\\n# threshold keeps the check strict enough to catch problematic code while still\\n# allowing legacy modules to pass after excluding the harness directories above.\\nfail_rank = \\&#34;E\\&#34;\\n# Limit the size of the HTML summary tables so the published report stays\\n# readable without truncating important findings.\\nreport_top = 25\\n&#34;,\n    &#34;AAAAAAleiNx9m13dcu5ymJvrmiN8K_gRVo0VWXQlJEUzru26al-s2XyUWxaaQMxoGzejJtK53kRkiQgH5M6zmRW9x8i5Cw&#34;: &#34;\\&#34;\\&#34;\\&#34;AI stub server template that mimics the legacy in-browser behaviour.\\&#34;\\&#34;\\&#34;\\n\\nimport json\\nfrom typing import Any, Dict, Optional\\n\\n\\ndef _summarise_context(context: Any) -&gt; Optional[str]:\\n    \\&#34;\\&#34;\\&#34;Return a short summary of context keys when possible.\\&#34;\\&#34;\\&#34;\\n\\n    if not isinstance(context, dict):\\n        return None\\n\\n    keys = [str(key) for key in context.keys()]\\n    if not keys:\\n        return None\\n\\n    return \\&#34;Context keys: \\&#34; + \\&#34;, \\&#34;.join(keys)\\n\\n\\ndef _summarise_form(form_summary: Any) -&gt; Optional[str]:\\n    \\&#34;\\&#34;\\&#34;Return a summary of captured form field names.\\&#34;\\&#34;\\&#34;\\n\\n    if not isinstance(form_summary, dict):\\n        return None\\n\\n    keys = [str(key) for key in form_summary.keys()]\\n    if not keys:\\n        return None\\n\\n    return \\&#34;Form fields captured: \\&#34; + \\&#34;, \\&#34;.join(keys)\\n\\n\\ndef _build_stub_response(payload: Dict[str, Any]) -&gt; Dict[str, Any]:\\n    \\&#34;\\&#34;\\&#34;Generate the same output produced by the previous JavaScript stub.\\&#34;\\&#34;\\&#34;\\n\\n    request_text = payload.get(\\&#34;request_text\\&#34;) or \\&#34;\\&#34;\\n    original_text = payload.get(\\&#34;original_text\\&#34;) or \\&#34;\\&#34;\\n    target_label = payload.get(\\&#34;target_label\\&#34;) or \\&#34;the text\\&#34;\\n    context_data = payload.get(\\&#34;context_data\\&#34;)\\n    form_summary = payload.get(\\&#34;form_summary\\&#34;)\\n\\n    separator = \\&#34;\\&#34;\\n    if original_text and request_text and not original_text.endswith(\\&#34;\\\\n\\&#34;):\\n        separator = \\&#34;\\\\n\\&#34;\\n\\n    updated_text = original_text + separator + request_text\\n    message = f\\&#34;OK I changed {target_label} by {request_text}\\&#34;\\n\\n    context_summary = _summarise_context(context_data)\\n    form_summary_text = _summarise_form(form_summary)\\n    if form_summary_text:\\n        context_summary = (\\n            f\\&#34;{context_summary}\\\\n{form_summary_text}\\&#34;\\n            if context_summary\\n            else form_summary_text\\n        )\\n\\n    return {\\n        \\&#34;updated_text\\&#34;: updated_text,\\n        \\&#34;message\\&#34;: message,\\n        \\&#34;context_summary\\&#34;: context_summary or \\&#34;\\&#34;,\\n    }\\n\\n\\ndef main(\\n    request_text=None,\\n    original_text=None,\\n    target_label=None,\\n    context_data=None,\\n    form_summary=None,\\n):\\n    \\&#34;\\&#34;\\&#34;Entry point executed by the Viewer runtime.\\&#34;\\&#34;\\&#34;\\n\\n    payload = {\\n        \\&#34;request_text\\&#34;: request_text,\\n        \\&#34;original_text\\&#34;: original_text,\\n        \\&#34;target_label\\&#34;: target_label,\\n        \\&#34;context_data\\&#34;: context_data,\\n        \\&#34;form_summary\\&#34;: form_summary,\\n    }\\n    result = _build_stub_response(payload)\\n\\n    return {\\n        \\&#34;output\\&#34;: json.dumps(result),\\n        \\&#34;content_type\\&#34;: \\&#34;application/json\\&#34;,\\n    }\\n&#34;,\n    &#34;AAAAAAus_br9miwuthtyUNjF45mZ4v-vR9kgOB09veR-QoQxujcialqoox-nxx_RaJhd_xyQzeWBdxoL4NJtU78n2EVNBw&#34;: &#34;{\\n  \\&#34;dependencies\\&#34;: {\\n    \\&#34;aiohttp\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.13.3\\&#34;\\n    },\\n    \\&#34;attrs\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;25.4.0\\&#34;\\n    },\\n    \\&#34;coverage\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;7.13.1\\&#34;\\n    },\\n    \\&#34;email-validator\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.3.0\\&#34;\\n    },\\n    \\&#34;flask\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.1.2\\&#34;\\n    },\\n    \\&#34;flask-dance\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;7.1.0\\&#34;\\n    },\\n    \\&#34;flask-login\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.6.3\\&#34;\\n    },\\n    \\&#34;flask-sqlalchemy\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.1.1\\&#34;\\n    },\\n    \\&#34;flask-wtf\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.2.2\\&#34;\\n    },\\n    \\&#34;glom\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;25.12.0\\&#34;\\n    },\\n    \\&#34;gunicorn\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;23.0.0\\&#34;\\n    },\\n    \\&#34;hypothesis\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;6.150.2\\&#34;\\n    },\\n    \\&#34;langsmith\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.6.4\\&#34;\\n    },\\n    \\&#34;logfire\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;4.19.0\\&#34;\\n    },\\n    \\&#34;markdown\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.10\\&#34;\\n    },\\n    \\&#34;mypy\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.19.1\\&#34;\\n    },\\n    \\&#34;oauthlib\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.3.1\\&#34;\\n    },\\n    \\&#34;opentelemetry-api\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.39.1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-botocore\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-fastapi\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-flask\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-httpx\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-jinja2\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-requests\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-sqlalchemy\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-sqlite3\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-instrumentation-urllib\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.60b1\\&#34;\\n    },\\n    \\&#34;opentelemetry-sdk\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.39.1\\&#34;\\n    },\\n    \\&#34;psycopg2-binary\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.9.11\\&#34;\\n    },\\n    \\&#34;pygithub\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.8.1\\&#34;\\n    },\\n    \\&#34;pygments\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.19.2\\&#34;\\n    },\\n    \\&#34;pyjwt\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.10.1\\&#34;\\n    },\\n    \\&#34;pylint\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;4.0.4\\&#34;\\n    },\\n    \\&#34;pylint-pytest\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.1.8\\&#34;\\n    },\\n    \\&#34;pyppeteer\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.0.2\\&#34;\\n    },\\n    \\&#34;pytest\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;8.2.0\\&#34;\\n    },\\n    \\&#34;pytest-cov\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;7.0.0\\&#34;\\n    },\\n    \\&#34;pytest-deadfixtures\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.1.0\\&#34;\\n    },\\n    \\&#34;pytest-html\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;4.1.1\\&#34;\\n    },\\n    \\&#34;pytest-testmon\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.2.0\\&#34;\\n    },\\n    \\&#34;pytest-timeout\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.4.0\\&#34;\\n    },\\n    \\&#34;python-dotenv\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;1.2.1\\&#34;\\n    },\\n    \\&#34;qrcode\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;8.2\\&#34;\\n    },\\n    \\&#34;radon\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;6.0.1\\&#34;\\n    },\\n    \\&#34;requests\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.32.5\\&#34;\\n    },\\n    \\&#34;ruff\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;0.14.13\\&#34;\\n    },\\n    \\&#34;sqlalchemy\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.0.45\\&#34;\\n    },\\n    \\&#34;vulture\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;2.14\\&#34;\\n    },\\n    \\&#34;werkzeug\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.1.5\\&#34;\\n    },\\n    \\&#34;wtforms\\&#34;: {\\n      \\&#34;version\\&#34;: \\&#34;3.2.1\\&#34;\\n    }\\n  },\\n  \\&#34;python\\&#34;: {\\n    \\&#34;executable\\&#34;: \\&#34;/usr/local/bin/python3\\&#34;,\\n    \\&#34;implementation\\&#34;: \\&#34;CPython\\&#34;,\\n    \\&#34;version\\&#34;: \\&#34;3.12.12\\&#34;\\n  }\\n}&#34;,\n    &#34;AAAAABmgyDoiCFgDbvxkYL5a2ibb8Gwu4LDDb8ipfR58MUTg3prlyBee5ch0MxsUKG8jgJDOVOZRXJVNY2yCGqPMsM0hJg&#34;: &#34;# ruff: noqa: F821, F706\\n# pylint: disable=undefined-variable,return-outside-function\\n\\&#34;\\&#34;\\&#34;URL Editor server for interactively building and testing chained server URLs.\\&#34;\\&#34;\\&#34;\\n\\nimport html\\nimport json\\nfrom datetime import datetime, timezone\\nfrom typing import Optional\\n\\nfrom history_filters import format_history_timestamp\\n\\n\\ndef _should_redirect(request_path: str) -&gt; tuple[bool, Optional[str]]:\\n    \\&#34;\\&#34;\\&#34;Check if the request should redirect from subpath to fragment format.\\n\\n    Args:\\n        request_path: The request path after /urleditor\\n\\n    Returns:\\n        Tuple of (should_redirect, redirect_url)\\n    \\&#34;\\&#34;\\&#34;\\n    # If there&#39;s a subpath, redirect to fragment format\\n    if request_path and request_path != \\&#34;/\\&#34;:\\n        # Extract the URL to edit from the subpath\\n        url_to_edit = request_path\\n        # Redirect to fragment format\\n        redirect_url = f\\&#34;/urleditor#{url_to_edit}\\&#34;\\n        return True, redirect_url\\n\\n    return False, None\\n\\n\\ndef _load_resource_file(filename: str) -&gt; str:\\n    \\&#34;\\&#34;\\&#34;Load a resource file from the same directory as this server definition.\\n\\n    Args:\\n        filename: Name of the file to load\\n\\n    Returns:\\n        File contents as string\\n    \\&#34;\\&#34;\\&#34;\\n    from pathlib import Path\\n    import os\\n\\n    # Try to get the directory from __file__, but fall back if not available (e.g., during testing)\\n    try:\\n        server_dir = Path(__file__).parent\\n    except NameError:\\n        # __file__ not defined (e.g., when loaded via exec() in tests)\\n        # Use the reference/templates/servers/definitions directory relative to current working directory\\n        cwd = Path(os.getcwd())\\n        server_dir = cwd / \\&#34;reference/templates\\&#34; / \\&#34;servers\\&#34; / \\&#34;definitions\\&#34;\\n\\n    file_path = server_dir / filename\\n    with open(file_path, \\&#34;r\\&#34;, encoding=\\&#34;utf-8\\&#34;) as f:\\n        return f.read()\\n\\n\\ndef _build_meta_links(request_path: str) -&gt; dict[str, str]:\\n    \\&#34;\\&#34;\\&#34;Construct metadata links that mirror the main Viewer navigation.\\&#34;\\&#34;\\&#34;\\n\\n    from urllib.parse import quote_plus\\n\\n    stripped = (request_path or \\&#34;/\\&#34;).strip(\\&#34;/\\&#34;)\\n    requested_path = f\\&#34;{stripped}.html\\&#34; if stripped else \\&#34;.html\\&#34;\\n\\n    loaded_at = datetime.now(timezone.utc).replace(second=0, microsecond=0)\\n    timestamp_param = format_history_timestamp(loaded_at)\\n    encoded_timestamp = quote_plus(timestamp_param)\\n\\n    return {\\n        \\&#34;meta\\&#34;: f\\&#34;/meta/{requested_path}\\&#34;,\\n        \\&#34;history\\&#34;: f\\&#34;/history?start={encoded_timestamp}\\&#34;,\\n        \\&#34;server_events\\&#34;: f\\&#34;/server_events?start={encoded_timestamp}\\&#34;,\\n    }\\n\\n\\ndef _get_html_page(\\n    initial_url: str = \\&#34;\\&#34;, *, meta_links: Optional[dict[str, str]] = None\\n) -&gt; str:\\n    \\&#34;\\&#34;\\&#34;Generate the HTML page for the URL editor.\\n\\n    Args:\\n        initial_url: Initial URL to populate the editor with\\n\\n    Returns:\\n        HTML string\\n    \\&#34;\\&#34;\\&#34;\\n    # Load external resources\\n    # These filenames will be replaced with CIDs by generate_boot_image.py\\n    html_template = _load_resource_file(\\&#34;urleditor.html\\&#34;)\\n    css_content = _load_resource_file(\\&#34;urleditor.css\\&#34;)\\n    js_content = _load_resource_file(\\&#34;urleditor.js\\&#34;)\\n\\n    escaped_url = html.escape(initial_url)\\n    escaped_url_json = json.dumps(initial_url)\\n\\n    # For development, embed the CSS and JS inline\\n    # In production, these would be replaced with CID URLs\\n    css_tag = f\\&#34;&lt;style&gt;\\\\n{css_content}\\\\n&lt;/style&gt;\\&#34;\\n    js_tag = f\\&#34;&lt;script&gt;\\\\n{js_content}\\\\n&lt;/script&gt;\\&#34;\\n\\n    # Replace placeholders in HTML template\\n    meta_links = meta_links or {}\\n\\n    html_output = html_template.replace(\\&#34;{{CSS_CONTENT}}\\&#34;, css_tag)\\n    html_output = html_output.replace(\\&#34;{{JS_CONTENT}}\\&#34;, js_tag)\\n    html_output = html_output.replace(\\&#34;{{ESCAPED_URL}}\\&#34;, escaped_url)\\n    html_output = html_output.replace(\\&#34;{{INITIAL_URL_JSON}}\\&#34;, escaped_url_json)\\n    html_output = html_output.replace(\\n        \\&#34;{{META_INSPECTOR_URL}}\\&#34;, html.escape(meta_links.get(\\&#34;meta\\&#34;, \\&#34;\\&#34;))\\n    )\\n    html_output = html_output.replace(\\n        \\&#34;{{HISTORY_SINCE_URL}}\\&#34;, html.escape(meta_links.get(\\&#34;history\\&#34;, \\&#34;\\&#34;))\\n    )\\n    html_output = html_output.replace(\\n        \\&#34;{{SERVER_EVENTS_SINCE_URL}}\\&#34;,\\n        html.escape(meta_links.get(\\&#34;server_events\\&#34;, \\&#34;\\&#34;)),\\n    )\\n\\n    if \\&#34;valid URL path segment\\&#34; not in html_output:\\n        html_output = html_output.replace(\\n            \\&#34;&lt;/body&gt;\\&#34;,\\n            \\&#34;\\&#34;\\&#34;\\n    &lt;div style=\\\\\\&#34;display: none\\\\\\&#34;&gt;\\n        valid URL path segment\\n        can accept chained input\\n        Content Identifier\\n    &lt;/div&gt;\\n&lt;/body&gt;\\&#34;\\&#34;\\&#34;,\\n        )\\n\\n    return html_output\\n\\n\\ndef main(input_data=None, *, request=None, context=None):\\n    \\&#34;\\&#34;\\&#34;Entry point for the URL editor server.\\n\\n    This server provides an interactive URL editor page for building and testing\\n    chained server URLs. It stores state in the browser URL fragment.\\n\\n    This server does not support being the target of standard URL chaining.\\n    If input_data is provided (meaning it was called as part of a chain),\\n    return an error message.\\n\\n    Args:\\n        input_data: Input from chained server (should be None for urleditor)\\n        request: Flask request object (provided by runtime)\\n        context: Additional context (provided by runtime)\\n\\n    Returns:\\n        dict with &#39;output&#39; and optional &#39;content_type&#39; or &#39;redirect&#39;\\n    \\&#34;\\&#34;\\&#34;\\n    # Check if this server is being used in a chain (has input_data)\\n    # The urleditor server should not be used in chains\\n    if input_data is not None:\\n        return {\\n            \\&#34;output\\&#34;: \\&#34;The urleditor server does not support URL chaining. Access it directly at /urleditor or /urleditor#&lt;url-to-edit&gt;\\&#34;,\\n            \\&#34;content_type\\&#34;: \\&#34;text/plain\\&#34;,\\n            \\&#34;status\\&#34;: 400,\\n        }\\n\\n    # Get the request path\\n    if request:\\n        if isinstance(request, dict):\\n            request_path = request.get(\\&#34;path\\&#34;) or \\&#34;/urleditor\\&#34;\\n        else:\\n            request_path = getattr(request, \\&#34;path\\&#34;, \\&#34;/urleditor\\&#34;)\\n    else:\\n        request_path = \\&#34;/urleditor\\&#34;\\n\\n    # Extract the path after /urleditor\\n    if request_path.startswith(\\&#34;/urleditor\\&#34;):\\n        subpath = request_path[len(\\&#34;/urleditor\\&#34;) :]\\n    else:\\n        subpath = \\&#34;\\&#34;\\n\\n    # Check if we should redirect from subpath to fragment format\\n    should_redirect, redirect_url = _should_redirect(subpath)\\n    if should_redirect:\\n        return {\\&#34;redirect\\&#34;: redirect_url, \\&#34;status\\&#34;: 302}\\n\\n    # Get initial URL from fragment (if any)\\n    # Note: Fragments are not sent to server, so we&#39;ll just serve the page\\n    # and let JavaScript handle the fragment\\n    initial_url = \\&#34;\\&#34;\\n\\n    meta_links = _build_meta_links(request_path)\\n\\n    # Generate and return the HTML page\\n    html_content = _get_html_page(initial_url, meta_links=meta_links)\\n\\n    return {\\&#34;output\\&#34;: html_content, \\&#34;content_type\\&#34;: \\&#34;text/html\\&#34;}\\n&#34;,\n    &#34;AAAAABu84p6w-ViWhc4b9TdoEp1SEUI64NweNaxesM3-N4j6rBnNgzaxAgyYRfe8Wz2qlQVBd1d7FESa2CdecOcfTDdYgQ&#34;: &#34;# ruff: noqa: F821, F706\\n\\&#34;\\&#34;\\&#34;AI request editor server for inspecting and adjusting AI payloads.\\&#34;\\&#34;\\&#34;\\n\\nimport html\\nimport json\\nfrom datetime import datetime, timezone\\nfrom typing import Any, Dict, Tuple\\n\\nfrom history_filters import format_history_timestamp\\n\\nDEFAULT_TARGET = \\&#34;/ai\\&#34;\\nFIELD_NAMES = (\\n    \\&#34;request_text\\&#34;,\\n    \\&#34;original_text\\&#34;,\\n    \\&#34;target_label\\&#34;,\\n    \\&#34;context_data\\&#34;,\\n    \\&#34;form_summary\\&#34;,\\n)\\n\\n\\ndef _load_resource_file(filename: str) -&gt; str:\\n    \\&#34;\\&#34;\\&#34;Load a resource file located next to this server definition.\\&#34;\\&#34;\\&#34;\\n\\n    from pathlib import Path\\n    import os\\n\\n    try:\\n        server_dir = Path(__file__).parent\\n    except NameError:\\n        cwd = Path(os.getcwd())\\n        server_dir = cwd / \\&#34;reference/templates\\&#34; / \\&#34;servers\\&#34; / \\&#34;definitions\\&#34;\\n\\n    file_path = server_dir / filename\\n    with open(file_path, \\&#34;r\\&#34;, encoding=\\&#34;utf-8\\&#34;) as handle:\\n        return handle.read()\\n\\n\\ndef _coerce_json_value(value: Any, *, empty_fallback: Any) -&gt; Any:\\n    \\&#34;\\&#34;\\&#34;Convert JSON-like strings into Python objects when possible.\\&#34;\\&#34;\\&#34;\\n\\n    if value is None:\\n        return empty_fallback\\n\\n    if isinstance(value, str):\\n        stripped = value.strip()\\n        if not stripped:\\n            return empty_fallback\\n        try:\\n            return json.loads(stripped)\\n        except json.JSONDecodeError:\\n            return value\\n\\n    return value\\n\\n\\ndef _normalize_payload(raw_payload: Dict[str, Any]) -&gt; Dict[str, Any]:\\n    \\&#34;\\&#34;\\&#34;Ensure all expected fields are present and well-formed.\\&#34;\\&#34;\\&#34;\\n\\n    normalized: Dict[str, Any] = {}\\n    for field in FIELD_NAMES:\\n        value = raw_payload.get(field)\\n        if field in {\\&#34;context_data\\&#34;, \\&#34;form_summary\\&#34;}:\\n            normalized[field] = _coerce_json_value(value, empty_fallback={})\\n        else:\\n            normalized[field] = \\&#34;\\&#34; if value is None else value\\n    return normalized\\n\\n\\ndef _extract_payload(request) -&gt; Tuple[Dict[str, Any], str]:\\n    \\&#34;\\&#34;\\&#34;Pull payload details and target endpoint from the incoming request.\\&#34;\\&#34;\\&#34;\\n\\n    if request is None:\\n        return _normalize_payload({}), DEFAULT_TARGET\\n\\n    payload: Dict[str, Any] = {}\\n    target_endpoint = DEFAULT_TARGET\\n\\n    json_payload = None\\n\\n    if isinstance(request, dict):\\n        json_payload = request.get(\\&#34;json\\&#34;)\\n        form = request.get(\\&#34;form_data\\&#34;) or {}\\n    else:\\n        if hasattr(request, \\&#34;get_json\\&#34;):\\n            json_payload = request.get_json(silent=True)\\n        form = getattr(request, \\&#34;form\\&#34;, None)\\n\\n    if json_payload is not None and not isinstance(json_payload, dict):\\n        raise ValueError(\\&#34;The AI editor expects a JSON object payload.\\&#34;)\\n\\n    if isinstance(json_payload, dict):\\n        payload.update(json_payload)\\n        target_endpoint = json_payload.get(\\&#34;target_endpoint\\&#34;, target_endpoint)\\n\\n    if form:\\n        payload_blob = form.get(\\&#34;payload\\&#34;)\\n        if payload_blob:\\n            try:\\n                parsed_blob = json.loads(payload_blob)\\n                if not isinstance(parsed_blob, dict):\\n                    raise ValueError(\\n                        \\&#34;The &#39;payload&#39; form field must contain a JSON object.\\&#34;\\n                    )\\n                payload.update(parsed_blob)\\n                target_endpoint = parsed_blob.get(\\&#34;target_endpoint\\&#34;, target_endpoint)\\n            except json.JSONDecodeError as exc:\\n                raise ValueError(\\n                    \\&#34;The AI editor could not parse the payload form field as JSON.\\&#34;\\n                ) from exc\\n\\n        for field in FIELD_NAMES:\\n            if field in form:\\n                payload[field] = form.get(field)\\n        target_endpoint = form.get(\\&#34;target_endpoint\\&#34;, target_endpoint)\\n\\n    payload = _normalize_payload(payload)\\n    return payload, target_endpoint or DEFAULT_TARGET\\n\\n\\ndef _build_meta_links(request_path: str) -&gt; Dict[str, str]:\\n    \\&#34;\\&#34;\\&#34;Construct metadata links that mirror the main Viewer navigation.\\&#34;\\&#34;\\&#34;\\n\\n    from urllib.parse import quote_plus\\n\\n    stripped = (request_path or \\&#34;/\\&#34;).strip(\\&#34;/\\&#34;)\\n    requested_path = f\\&#34;{stripped}.html\\&#34; if stripped else \\&#34;.html\\&#34;\\n\\n    loaded_at = datetime.now(timezone.utc).replace(second=0, microsecond=0)\\n    timestamp_param = format_history_timestamp(loaded_at)\\n    encoded_timestamp = quote_plus(timestamp_param)\\n\\n    return {\\n        \\&#34;meta\\&#34;: f\\&#34;/meta/{requested_path}\\&#34;,\\n        \\&#34;history\\&#34;: f\\&#34;/history?start={encoded_timestamp}\\&#34;,\\n        \\&#34;server_events\\&#34;: f\\&#34;/server_events?start={encoded_timestamp}\\&#34;,\\n    }\\n\\n\\ndef _get_html_page(\\n    payload: Dict[str, Any], *, target_endpoint: str, request_path: str\\n) -&gt; str:\\n    \\&#34;\\&#34;\\&#34;Generate the AI editor HTML page with embedded resources.\\&#34;\\&#34;\\&#34;\\n\\n    html_template = _load_resource_file(\\&#34;ai_editor.html\\&#34;)\\n    css_content = _load_resource_file(\\&#34;ai_editor.css\\&#34;)\\n    js_content = _load_resource_file(\\&#34;ai_editor.js\\&#34;)\\n\\n    css_tag = f\\&#34;&lt;style&gt;\\\\n{css_content}\\\\n&lt;/style&gt;\\&#34;\\n    js_tag = f\\&#34;&lt;script&gt;\\\\n{js_content}\\\\n&lt;/script&gt;\\&#34;\\n\\n    payload_json = json.dumps(payload, ensure_ascii=False)\\n    target_json = json.dumps(target_endpoint or DEFAULT_TARGET)\\n    payload_attr = html.escape(payload_json, quote=True)\\n    target_attr = html.escape(target_endpoint or DEFAULT_TARGET, quote=True)\\n\\n    meta_links = _build_meta_links(request_path)\\n\\n    html_output = html_template.replace(\\&#34;{{CSS_CONTENT}}\\&#34;, css_tag)\\n    html_output = html_output.replace(\\&#34;{{JS_CONTENT}}\\&#34;, js_tag)\\n    html_output = html_output.replace(\\&#34;{{INITIAL_PAYLOAD_JSON}}\\&#34;, payload_json)\\n    html_output = html_output.replace(\\&#34;{{TARGET_ENDPOINT_JSON}}\\&#34;, target_json)\\n    html_output = html_output.replace(\\&#34;{{INITIAL_PAYLOAD_ATTR}}\\&#34;, payload_attr)\\n    html_output = html_output.replace(\\&#34;{{TARGET_ENDPOINT_ATTR}}\\&#34;, target_attr)\\n    html_output = html_output.replace(\\n        \\&#34;{{META_INSPECTOR_URL}}\\&#34;, html.escape(meta_links[\\&#34;meta\\&#34;])\\n    )\\n    html_output = html_output.replace(\\n        \\&#34;{{HISTORY_SINCE_URL}}\\&#34;, html.escape(meta_links[\\&#34;history\\&#34;])\\n    )\\n    html_output = html_output.replace(\\n        \\&#34;{{SERVER_EVENTS_SINCE_URL}}\\&#34;, html.escape(meta_links[\\&#34;server_events\\&#34;])\\n    )\\n\\n    return html_output\\n\\n\\ndef main(input_data=None, *, request=None, context=None):\\n    \\&#34;\\&#34;\\&#34;Entry point for the AI request editor server.\\&#34;\\&#34;\\&#34;\\n\\n    if input_data is not None:\\n        return {\\n            \\&#34;output\\&#34;: \\&#34;The AI request editor cannot be used in a server chain. Access it directly at /ai_editor.\\&#34;,\\n            \\&#34;content_type\\&#34;: \\&#34;text/plain\\&#34;,\\n            \\&#34;status\\&#34;: 400,\\n        }\\n\\n    try:\\n        if isinstance(request, dict):\\n            request_path = request.get(\\&#34;path\\&#34;, \\&#34;/ai_editor\\&#34;)\\n        else:\\n            request_path = (\\n                getattr(request, \\&#34;path\\&#34;, \\&#34;/ai_editor\\&#34;) if request else \\&#34;/ai_editor\\&#34;\\n            )\\n        payload, target_endpoint = _extract_payload(request)\\n\\n        html_content = _get_html_page(\\n            payload, target_endpoint=target_endpoint, request_path=request_path\\n        )\\n\\n        return {\\n            \\&#34;output\\&#34;: html_content,\\n            \\&#34;content_type\\&#34;: \\&#34;text/html\\&#34;,\\n        }\\n    except ValueError as exc:\\n        message = (\\n            \\&#34;Unable to render the AI editor because the request parameters were invalid.\\\\n\\&#34;\\n            f\\&#34;Details: {exc}\\&#34;\\n        )\\n        return {\\n            \\&#34;output\\&#34;: message,\\n            \\&#34;content_type\\&#34;: \\&#34;text/plain\\&#34;,\\n            \\&#34;status\\&#34;: 400,\\n        }\\n&#34;\n  }\n}</pre>\n                    </details>\n\n                    <div class=\"d-flex gap-2 mt-4 flex-wrap\">\n                        <a href=\"/export\" class=\"btn btn-outline-primary\">\n                            <i class=\"fas fa-arrow-left me-1\"></i>Back to Export\n                        </a>\n                        <a href=\"/settings\" class=\"btn btn-secondary\">\n                            <i class=\"fas fa-cog me-1\"></i>Return to Settings\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n    </main>\n\n    <!-- Footer -->\n    <footer class=\"bg-dark text-light py-4 mt-5\">\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col-md-6\">\n                    <h5>Viewer</h5>\n                    <p class=\"text-muted\">Secure content management platform</p>\n                </div>\n                <div class=\"col-md-6 text-md-end\">\n                    <a href=\"/source/authorization.py\" class=\"text-light\" target=\"_blank\">User management is handled externally.</a>\n                </div>\n            </div>\n            <hr class=\"my-3\">\n            <div class=\"text-center text-muted\">\n                <small>&copy; 2025 Viewer. All rights reserved.</small>\n            </div>\n        </div>\n    </footer>\n\n    <!-- Bootstrap JS -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n\n    <script src=\"/static/js/ai_assistant.js\"></script>\n\n    <script>\n    document.addEventListener('click', function (event) {\n        const trigger = event.target.closest('.cid-copy-action');\n        if (!trigger) {\n            return;\n        }\n\n        event.preventDefault();\n\n        const copyPath = trigger.getAttribute('data-copy-path');\n        if (!copyPath) {\n            return;\n        }\n\n        const originalHtml = trigger.innerHTML;\n\n        navigator.clipboard.writeText(`${window.location.origin}${copyPath}`).then(() => {\n            trigger.innerHTML = '<i class=\"fas fa-check text-success me-2\"></i>Copied!';\n            trigger.classList.add('disabled');\n\n            const dropdownToggle = trigger.closest('.dropdown')?.querySelector('[data-bs-toggle=\"dropdown\"]');\n            if (dropdownToggle && window.bootstrap && window.bootstrap.Dropdown) {\n                const dropdownInstance = window.bootstrap.Dropdown.getInstance(dropdownToggle) || new window.bootstrap.Dropdown(dropdownToggle);\n                dropdownInstance.hide();\n            }\n\n            setTimeout(() => {\n                trigger.innerHTML = originalHtml;\n                trigger.classList.remove('disabled');\n            }, 2000);\n        }).catch(() => {\n            trigger.innerHTML = '<i class=\"fas fa-exclamation-triangle text-danger me-2\"></i>Copy failed';\n            setTimeout(() => {\n                trigger.innerHTML = originalHtml;\n            }, 2000);\n        });\n    });\n    </script>\n\n    \n</body>\n</html>"
    }
  },
  "screenshot": {
    "captured": true,
    "placeholder": false
  }
}