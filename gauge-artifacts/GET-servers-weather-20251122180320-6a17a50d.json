{
  "label": "GET /servers/weather",
  "captured_at": "2025-11-22T18:03:20Z",
  "preview": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Viewer</title>\n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n\n    <!-- Custom CSS -->\n    <link href=\"/static/custom.css\" rel=\"stylesheet\">\n\n    <!-- Font Awesome for icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n</head>\n<body>\n    <!-- Navigation -->\n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n        <div class=\"container\">\n            <div class=\"viewer-menu dropdown\">\n                <div class=\"btn-group viewer-menu-group\" role=\"group\">\n                    <a class=\"navbar-brand fw-bold viewer-menu-home\" href=\"/\">\n                        <i class=\"fas fa-shield-alt me-2\"></i>Viewer\n                    </a>\n                    <button\n                        class=\"btn btn-link dropdown-toggle dropdown-toggle-split viewer-menu-toggle\"\n                        type=\"button\"\n                        id=\"viewerMenuToggle\"\n                        data-bs-to",
  "request": {
    "method": "GET",
    "path": "/servers/weather?",
    "url": "http://localhost/servers/weather",
    "headers": [
      {
        "name": "User-Agent",
        "value": "Werkzeug/3.1.3"
      },
      {
        "name": "Host",
        "value": "localhost"
      },
      {
        "name": "Cookie",
        "value": "session=eyJfcGVybWFuZW50Ijp0cnVlLCJjc3JmX3Rva2VuIjoiOTIzOWM2ODA4YzI4ZjFhNzRkYzg1ZDViYTk3YTM2NDM3OTJhZTZhZSJ9.aSH66A.-9BizsriA_AVVfiqKl1WN5aP7wA"
      }
    ],
    "query": {},
    "body": {
      "encoding": "utf-8",
      "text": ""
    }
  },
  "response": {
    "status_code": 200,
    "mimetype": "text/html",
    "headers": [
      {
        "name": "Content-Type",
        "value": "text/html; charset=utf-8"
      },
      {
        "name": "Content-Length",
        "value": "49657"
      },
      {
        "name": "Vary",
        "value": "Cookie"
      },
      {
        "name": "Set-Cookie",
        "value": "session=eyJfcGVybWFuZW50Ijp0cnVlLCJjc3JmX3Rva2VuIjoiOTIzOWM2ODA4YzI4ZjFhNzRkYzg1ZDViYTk3YTM2NDM3OTJhZTZhZSJ9.aSH66A.-9BizsriA_AVVfiqKl1WN5aP7wA; Expires=Tue, 23 Dec 2025 18:03:20 GMT; HttpOnly; Path=/"
      }
    ],
    "body": {
      "encoding": "utf-8",
      "text": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Viewer</title>\n\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n\n    <!-- Custom CSS -->\n    <link href=\"/static/custom.css\" rel=\"stylesheet\">\n\n    <!-- Font Awesome for icons -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n</head>\n<body>\n    <!-- Navigation -->\n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n        <div class=\"container\">\n            <div class=\"viewer-menu dropdown\">\n                <div class=\"btn-group viewer-menu-group\" role=\"group\">\n                    <a class=\"navbar-brand fw-bold viewer-menu-home\" href=\"/\">\n                        <i class=\"fas fa-shield-alt me-2\"></i>Viewer\n                    </a>\n                    <button\n                        class=\"btn btn-link dropdown-toggle dropdown-toggle-split viewer-menu-toggle\"\n                        type=\"button\"\n                        id=\"viewerMenuToggle\"\n                        data-bs-toggle=\"dropdown\"\n                        data-bs-auto-close=\"outside\"\n                        aria-expanded=\"false\"\n                        aria-label=\"Open Viewer navigation menu\"\n                    ></button>\n                    <ul class=\"dropdown-menu shadow\" aria-labelledby=\"viewerMenuToggle\" data-viewer-menu>\n                        <li class=\"dropdown-header text-uppercase small text-muted\">Workspace</li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/uploads\">\n                                <i class=\"fas fa-upload text-muted\"></i>\n                                <span>Uploads</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/server_events\">\n                                <i class=\"fas fa-server text-muted\"></i>\n                                <span>Server Events</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/history\">\n                                <i class=\"fas fa-history text-muted\"></i>\n                                <span>History</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/export\">\n                                <i class=\"fas fa-download text-muted\"></i>\n                                <span>Export Data</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/import\">\n                                <i class=\"fas fa-file-import text-muted\"></i>\n                                <span>Import Data</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/openapi\">\n                                <i class=\"fas fa-book text-muted\"></i>\n                                <span>API Docs</span>\n                            </a>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-link text-muted\"></i>\n                                <span>Aliases</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-aliases>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/aliases\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All aliases</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/aliases/CSS\">CSS</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/aliases/ai\">ai</a>\n                                            \n                                        </li>\n                                    \n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-server text-muted\"></i>\n                                <span>Servers</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-servers>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/servers\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All servers</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/ai_stub\">ai_stub</a>\n                                            \n                                        </li>\n                                    \n                                        \n                                        <li>\n                                            \n                                                <a class=\"dropdown-item\" href=\"/servers/weather\">weather</a>\n                                            \n                                        </li>\n                                    \n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-code text-muted\"></i>\n                                <span>Variables</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-variables>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/variables\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All variables</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    <li>\n                                        <span class=\"dropdown-item-text text-muted small\">No variables yet</span>\n                                    </li>\n                                \n                            </ul>\n                        </li>\n                        <li class=\"dropdown-submenu dropend\">\n                            <a\n                                class=\"dropdown-item dropdown-toggle d-flex align-items-center gap-2\"\n                                href=\"#\"\n                                role=\"button\"\n                                data-bs-toggle=\"dropdown\"\n                                data-bs-auto-close=\"outside\"\n                                aria-expanded=\"false\"\n                            >\n                                <i class=\"fas fa-key text-muted\"></i>\n                                <span>Secrets</span>\n                            </a>\n                            <ul class=\"dropdown-menu\" data-viewer-secrets>\n                                <li>\n                                    <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/secrets\">\n                                        <i class=\"fas fa-list text-muted\"></i>\n                                        <span>All secrets</span>\n                                    </a>\n                                </li>\n                                <li><hr class=\"dropdown-divider\"></li>\n                                \n                                    <li>\n                                        <span class=\"dropdown-item-text text-muted small\">No secrets yet</span>\n                                    </li>\n                                \n                            </ul>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/routes\">\n                                <i class=\"fas fa-diagram-project text-muted\"></i>\n                                <span>Routes</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/source\">\n                                <i class=\"fas fa-file-code text-muted\"></i>\n                                <span>Source</span>\n                            </a>\n                        </li>\n                        <li><hr class=\"dropdown-divider\"></li>\n                        <li class=\"dropdown-header text-uppercase small text-muted\">Account</li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/profile\">\n                                <i class=\"fas fa-id-badge text-muted\"></i>\n                                <span>Profile</span>\n                            </a>\n                        </li>\n                        <li>\n                            <a class=\"dropdown-item d-flex align-items-center gap-2\" href=\"/settings\">\n                                <i class=\"fas fa-sliders-h text-muted\"></i>\n                                <span>Settings</span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\">\n                <span class=\"navbar-toggler-icon\"></span>\n            </button>\n\n            <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n                <ul class=\"navbar-nav me-auto align-items-lg-center\">\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/search\">\n                            <i class=\"fas fa-magnifying-glass me-1\"></i>Search\n                        </a>\n                    </li>\n                </ul>\n\n                <ul class=\"navbar-nav align-items-center\">\n                    <li class=\"nav-item\">\n                        <a\n                            class=\"nav-link text-light\"\n                            href=\"/meta/servers/weather.html\"\n                            title=\"View metadata for this page\"\n                            aria-label=\"View metadata for this page\"\n                        >\n                            <i class=\"fas fa-circle-info\"></i>\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <!-- Flash Messages -->\n    \n        \n    \n\n    <!-- Main Content -->\n    <main class=\"py-4\">\n        \n\n<style>pre { line-height: 125%; }\ntd.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\nspan.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }\ntd.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\nspan.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }\n.codehilite .hll { background-color: #ffffcc }\n.codehilite { background: #f8f8f8; }\n.codehilite .c { color: #3D7B7B; font-style: italic } /* Comment */\n.codehilite .err { border: 1px solid #F00 } /* Error */\n.codehilite .k { color: #008000; font-weight: bold } /* Keyword */\n.codehilite .o { color: #666 } /* Operator */\n.codehilite .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */\n.codehilite .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */\n.codehilite .cp { color: #9C6500 } /* Comment.Preproc */\n.codehilite .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */\n.codehilite .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */\n.codehilite .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */\n.codehilite .gd { color: #A00000 } /* Generic.Deleted */\n.codehilite .ge { font-style: italic } /* Generic.Emph */\n.codehilite .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */\n.codehilite .gr { color: #E40000 } /* Generic.Error */\n.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */\n.codehilite .gi { color: #008400 } /* Generic.Inserted */\n.codehilite .go { color: #717171 } /* Generic.Output */\n.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */\n.codehilite .gs { font-weight: bold } /* Generic.Strong */\n.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */\n.codehilite .gt { color: #04D } /* Generic.Traceback */\n.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */\n.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */\n.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */\n.codehilite .kp { color: #008000 } /* Keyword.Pseudo */\n.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */\n.codehilite .kt { color: #B00040 } /* Keyword.Type */\n.codehilite .m { color: #666 } /* Literal.Number */\n.codehilite .s { color: #BA2121 } /* Literal.String */\n.codehilite .na { color: #687822 } /* Name.Attribute */\n.codehilite .nb { color: #008000 } /* Name.Builtin */\n.codehilite .nc { color: #00F; font-weight: bold } /* Name.Class */\n.codehilite .no { color: #800 } /* Name.Constant */\n.codehilite .nd { color: #A2F } /* Name.Decorator */\n.codehilite .ni { color: #717171; font-weight: bold } /* Name.Entity */\n.codehilite .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */\n.codehilite .nf { color: #00F } /* Name.Function */\n.codehilite .nl { color: #767600 } /* Name.Label */\n.codehilite .nn { color: #00F; font-weight: bold } /* Name.Namespace */\n.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */\n.codehilite .nv { color: #19177C } /* Name.Variable */\n.codehilite .ow { color: #A2F; font-weight: bold } /* Operator.Word */\n.codehilite .w { color: #BBB } /* Text.Whitespace */\n.codehilite .mb { color: #666 } /* Literal.Number.Bin */\n.codehilite .mf { color: #666 } /* Literal.Number.Float */\n.codehilite .mh { color: #666 } /* Literal.Number.Hex */\n.codehilite .mi { color: #666 } /* Literal.Number.Integer */\n.codehilite .mo { color: #666 } /* Literal.Number.Oct */\n.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */\n.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */\n.codehilite .sc { color: #BA2121 } /* Literal.String.Char */\n.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */\n.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */\n.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */\n.codehilite .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */\n.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */\n.codehilite .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */\n.codehilite .sx { color: #008000 } /* Literal.String.Other */\n.codehilite .sr { color: #A45A77 } /* Literal.String.Regex */\n.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */\n.codehilite .ss { color: #19177C } /* Literal.String.Symbol */\n.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */\n.codehilite .fm { color: #00F } /* Name.Function.Magic */\n.codehilite .vc { color: #19177C } /* Name.Variable.Class */\n.codehilite .vg { color: #19177C } /* Name.Variable.Global */\n.codehilite .vi { color: #19177C } /* Name.Variable.Instance */\n.codehilite .vm { color: #19177C } /* Name.Variable.Magic */\n.codehilite .il { color: #666 } /* Literal.Number.Integer.Long */</style>\n\n\n\n\n<div class=\"container-fluid py-4 px-4\">\n    <div class=\"d-flex flex-wrap justify-content-between align-items-center gap-3 mb-4\">\n        <h2 class=\"mb-0\"><i class=\"fas fa-server me-2\"></i>weather</h2>\n        <div class=\"btn-group flex-wrap\">\n            <a href=\"/servers\" class=\"btn btn-secondary\">\n                <i class=\"fas fa-arrow-left me-1\"></i>Back to Servers\n            </a>\n            <a href=\"/servers/weather/edit\" class=\"btn btn-primary\">\n                <i class=\"fas fa-edit me-1\"></i>Edit Server\n            </a>\n        </div>\n    </div>\n\n    <ul class=\"nav nav-tabs\" id=\"server-view-tabs\" role=\"tablist\">\n        <li class=\"nav-item\" role=\"presentation\">\n            <button class=\"nav-link active\" id=\"server-view-definition-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#server-view-definition\" type=\"button\" role=\"tab\" aria-controls=\"server-view-definition\" aria-selected=\"true\">\n                <i class=\"fas fa-code me-1\"></i>Definition\n            </button>\n        </li>\n        <li class=\"nav-item\" role=\"presentation\">\n            <button class=\"nav-link\" id=\"server-view-docs-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#server-view-docs\" type=\"button\" role=\"tab\" aria-controls=\"server-view-docs\" aria-selected=\"false\">\n                <i class=\"fas fa-book me-1\"></i>Docs\n            </button>\n        </li>\n        <li class=\"nav-item\" role=\"presentation\">\n            <button class=\"nav-link\" id=\"server-view-details-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#server-view-details\" type=\"button\" role=\"tab\" aria-controls=\"server-view-details\" aria-selected=\"false\">\n                <i class=\"fas fa-info-circle me-1\"></i>Details\n            </button>\n        </li>\n        \n        \n        <li class=\"nav-item\" role=\"presentation\">\n            <button class=\"nav-link\" id=\"server-view-test-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#server-view-test\" type=\"button\" role=\"tab\" aria-controls=\"server-view-test\" aria-selected=\"false\">\n                <i class=\"fas fa-vial me-1\"></i>Test\n            </button>\n        </li>\n        \n        \n        \n    </ul>\n\n    <div class=\"tab-content py-4\" id=\"server-view-tabs-content\">\n        <div class=\"tab-pane fade show active\" id=\"server-view-definition\" role=\"tabpanel\" aria-labelledby=\"server-view-definition-tab\">\n            <div class=\"card shadow-sm\">\n                <div class=\"card-header d-flex flex-wrap justify-content-between align-items-center gap-2\">\n                    <h5 class=\"card-title mb-0\">Server Definition</h5>\n                    <div class=\"d-flex gap-2\">\n                        <button class=\"btn btn-outline-secondary btn-sm\" onclick=\"copyDefinition()\">\n                            <i class=\"fas fa-copy me-1\"></i>Copy\n                        </button>\n                        <form method=\"POST\" action=\"/servers/weather/delete\"\n                              onsubmit=\"return confirm('Are you sure you want to delete server weather?')\" class=\"d-inline\">\n                            <button type=\"submit\" class=\"btn btn-outline-danger btn-sm\">\n                                <i class=\"fas fa-trash me-1\"></i>Delete\n                            </button>\n                        </form>\n                    </div>\n                </div>\n                <div class=\"card-body\">\n                    \n                        <div class=\"codehilite border rounded\" style=\"max-height: 500px; overflow: auto;\">\n                            <pre id=\"server-definition\" class=\"mb-0 px-3 py-2\" style=\"overflow:auto;\"><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">main</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"s1\">&#39;Weather forecast ready&#39;</span>\n</pre>\n                        </div>\n                    \n                </div>\n                <div class=\"card-footer text-muted\">\n                    <div class=\"row\">\n                        <div class=\"col-md-6\">\n                            <small>\n                                <i class=\"fas fa-calendar-plus me-1\"></i>\n                                Created: 2025-11-22 18:03:20\n                            </small>\n                        </div>\n                        <div class=\"col-md-6 text-md-end\">\n                            \n                            <small>\n                                <i class=\"fas fa-calendar-edit me-1\"></i>\n                                Last Updated: 2025-11-22 18:03:20\n                            </small>\n                            \n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"tab-pane fade\" id=\"server-view-docs\" role=\"tabpanel\" aria-labelledby=\"server-view-docs-tab\">\n            <div class=\"card shadow-sm\">\n    <div class=\"card-header\">\n        <h5 class=\"card-title mb-0\"><i class=\"fas fa-book me-2\"></i>Server authoring reference</h5>\n    </div>\n    <div class=\"card-body\">\n        <p class=\"mb-3\">\n            Server definitions run as Python modules executed by\n            <a href=\"/source/server_execution.py\" class=\"text-decoration-none\">server_execution.py</a>.\n            When a <code>main()</code> function is present, Viewer automatically maps request data into its\n            parameters so the handler can focus on rendering a response.\n        </p>\n        <p class=\"mb-3\">\n            Parameters are populated in priority order from the query string, JSON or form body, HTTP headers\n            (hyphen/underscore normalised), explicit invocation arguments, saved variables, then saved secrets.\n            Missing required parameters receive a JSON 400 response describing how to provide each value.\n            When an auto-main server only needs a single value, the segment immediately following its name in the URL can also\n            satisfy that parameter by resolving another server, alias, or CID before invoking the outer server (for example,\n            <code>/outer/&lt;nested-server&gt;</code> runs the nested server first and passes its output to <code>outer</code>).\n        </p>\n        <p class=\"mb-3\">\n            If a server has multiple parameters, Viewer attempts to resolve as many values as possible using the usual sources.\n            When exactly one parameter remains unresolved, that final value is filled using the next URL segment with the same\n            nested server/alias/CID lookup rules described above. If more than one parameter is still missing after these\n            lookups, Viewer renders an HTML 400 page describing every supplied and missing parameter to help debug the request.\n        </p>\n        <p class=\"mb-3\">\n            The return value can be a dictionary with <code>output</code> and <code>content_type</code>, a tuple of\n            <code>(output, content_type)</code>, or any other value which is sent as HTML. The execution layer stores the\n            rendered payload as a CID and redirects the caller to that resource. Helper functions can be invoked by\n            appending their name to the server URL when their signatures pass validation. Tested reference examples live in\n            <a href=\"/source/reference_templates/servers/definitions\" class=\"text-decoration-none\">reference_templates/servers/definitions</a>.\n        </p>\n        <p class=\"mb-2\">Key automated checks covering this behaviour:</p>\n        <ul class=\"mb-3\">\n            <li>\n                <a href=\"/source/tests/test_server_auto_main.py\" class=\"text-decoration-none\">tests/test_server_auto_main.py</a>\n                exercises auto-mapped parameters, helper execution, and error handling.\n            </li>\n            <li>\n                <a href=\"/source/tests/test_server_execution_output_encoding.py\" class=\"text-decoration-none\">tests/test_server_execution_output_encoding.py</a>\n                ensures return values are encoded, logged, and redirected consistently.\n            </li>\n            <li>\n                <a href=\"/source/tests/integration/test_server_pages.py\" class=\"text-decoration-none\">tests/integration/test_server_pages.py</a>\n                verifies the UI surfaces server metadata, history snapshots, and invocation records.\n            </li>\n        </ul>\n        <p class=\"mb-0\">\n            For a broader catalogue of coverage, see the cross references in\n            <a href=\"/source/docs/page_test_cross_reference.md\" class=\"text-decoration-none\">docs/page_test_cross_reference.md</a>\n            and the index entries in\n            <a href=\"/source/TEST_INDEX.md\" class=\"text-decoration-none\">TEST_INDEX.md</a>.\n        </p>\n    </div>\n</div>\n        </div>\n\n        <div class=\"tab-pane fade\" id=\"server-view-details\" role=\"tabpanel\" aria-labelledby=\"server-view-details-tab\">\n            <div class=\"card shadow-sm\">\n                <div class=\"card-header\">\n                    <h5 class=\"card-title mb-0\">Server Information</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"row g-4\">\n                        <div class=\"col-lg-6\">\n                            <strong>Server Name:</strong><br>\n                            <code>weather</code>\n                        </div>\n                        <div class=\"col-lg-6\">\n                            <strong>Status:</strong><br>\n                            \n                            <span class=\"badge text-bg-success\">Enabled</span>\n                            \n                        </div>\n                        <div class=\"col-lg-6\">\n                            <strong>Direct URL:</strong><br>\n                            <code><a href=\"http://localhost/servers/weather\">http://localhost/servers/weather</a></code>\n                        </div>\n                        <div class=\"col-lg-6\">\n                            <strong>Definition Length:</strong><br>\n                            55 characters\n                        </div>\n                        <div class=\"col-lg-6\">\n                            <strong>Line Count:</strong><br>\n                            3 lines\n                        </div>\n                        \n                    </div>\n                </div>\n            </div>\n        </div>\n\n        \n\n        \n        <div class=\"tab-pane fade\" id=\"server-view-test\" role=\"tabpanel\" aria-labelledby=\"server-view-test-tab\">\n            \n<div class=\"card mt-4\" id=\"server-test-card\">\n    <div class=\"card-header d-flex justify-content-between align-items-center\">\n        <h5 class=\"card-title mb-0\"><i class=\"fas fa-vial me-2\"></i>Test Server</h5>\n        <span class=\"badge bg-light text-dark\">Preview</span>\n    </div>\n    <div class=\"card-body\">\n        <p class=\"text-muted mb-3\">\n            Simulate a request to <code>/weather</code> using this server's current definition.\n            Results open in a new tab so you can continue editing.\n        </p>\n\n        <form id=\"server-test-form\"\n              class=\"server-test-form\"\n              data-mode=\"main\"\n              data-action=\"/weather\"\n              \n              onsubmit=\"submitServerTestForm(event)\">\n            <div id=\"server-test-result\" class=\"alert mt-3 d-none\" role=\"alert\"></div>\n\n            <div id=\"server-test-main-section\" class=\"\">\n                <div class=\"row g-3\" id=\"server-test-parameters\">\n                    \n                    <div class=\"col-md-6\">\n                        <label for=\"server-test-param-0\" class=\"form-label\">\n                            context\n                            \n                            <span class=\"badge bg-danger ms-2\">Required</span>\n                            \n                        </label>\n                        <textarea class=\"form-control\"\n                                  id=\"server-test-param-0\"\n                                  name=\"context\"\n                                  rows=\"3\"\n                                  placeholder=\"Value for context\"></textarea>\n                    </div>\n                    \n                </div>\n                <p id=\"server-test-no-parameters\" class=\"text-muted mt-3 d-none\">\n                    This <code>main()</code> function does not accept parameters. Run the test to execute it directly.\n                </p>\n            </div>\n\n            <div id=\"server-test-query-section\" class=\"d-none\">\n                <div class=\"mb-3\">\n                    <label for=\"server-test-query\" class=\"form-label\">Query Parameters</label>\n                    <textarea class=\"form-control\"\n                              id=\"server-test-query\"\n                              rows=\"4\"\n                              placeholder=\"key=value\"></textarea>\n                    <div class=\"form-text\">\n                        Enter each parameter on a new line in <code>key=value</code> format. Empty lines are ignored.\n                    </div>\n                </div>\n                \n    \n    \n    \n    <div class=\"mb-3 ai-text-assistant\"\n         data-ai-target-id=\"server-test-query\"\n         data-ai-target-label=\"query parameters\"\n         data-ai-history-limit=\"10\"\n         data-ai-entity-type=\"server-test\"\n         data-ai-entity-name=\"/weather\"\n         \n         data-ai-context='{\"form\": \"server_test_card\"}'>\n        <label for=\"server-test-query-ai-input\" class=\"form-label\">Ask AI to edit the query parameters</label>\n        <textarea id=\"server-test-query-ai-input\"\n                  class=\"form-control\"\n                  rows=\"3\"\n                  data-ai-input\n                  placeholder=\"Share instructions for AI or summarise manual edits to the query parameters.\"></textarea>\n        <div class=\"form-text\">Describe how the AI should adjust the query parameters before running the test.</div>\n        <input type=\"hidden\" name=\"change_message\" data-change-message-store>\n        <div class=\"alert alert-info d-none mt-3\"\n             id=\"server-test-query-ai-output\"\n             data-ai-output\n             role=\"status\"></div>\n        <div class=\"mt-3\">\n            <label class=\"form-label small text-uppercase fw-semibold\">Recent test runs</label>\n            <div class=\"list-group list-group-flush border rounded\" data-ai-history-list>\n                \n            </div>\n            <div class=\"text-muted small mt-2 \" data-ai-history-empty>\n                No interactions yet.\n            </div>\n        </div>\n    </div>\n\n            </div>\n\n            <div class=\"d-flex gap-2 mt-3 flex-wrap\">\n                <button type=\"submit\" class=\"btn btn-primary\">\n                    <i class=\"fas fa-play me-1\"></i>Run Test\n                </button>\n                <div id=\"server-test-ai-wrapper\" class=\"d-none\">\n                    \n    \n    \n        \n    \n    <button type=\"button\"\n            class=\"btn btn-outline-primary\"\n            data-ai-trigger\n            data-ai-target-id=\"server-test-query\">\n        <i class=\"fas fa-robot me-1\"></i>AI\n    </button>\n\n                </div>\n                <button type=\"button\" class=\"btn btn-outline-secondary\" onclick=\"resetServerTestForm(this.form)\">\n                    <i class=\"fas fa-undo me-1\"></i>Clear Inputs\n                </button>\n                \n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction _escapeServerTestHtml(value) {\n    if (typeof value !== 'string') {\n        return '';\n    }\n    return value\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#39;');\n}\n\nfunction _resolveServerTestResultUrl(url) {\n    if (!url) {\n        return { absolute: null, display: null };\n    }\n\n    try {\n        const parsed = new URL(url, window.location.href);\n        const absolute = parsed.toString();\n        const display = parsed.origin === window.location.origin\n            ? `${parsed.pathname}${parsed.search}${parsed.hash}`\n            : absolute;\n        return { absolute, display };\n    } catch (error) {\n        if (typeof url === 'string' && url.startsWith('/')) {\n            try {\n                const parsed = new URL(url, window.location.href);\n                return { absolute: parsed.toString(), display: url };\n            } catch (innerError) {\n                return { absolute: url, display: url };\n            }\n        }\n        return { absolute: url, display: url };\n    }\n}\n\nfunction _extractServerTestFailure(body, contentType) {\n    if (typeof body !== 'string' || body.length === 0) {\n        return {};\n    }\n\n    const result = { sourceLink: undefined };\n\n    if (contentType && contentType.includes('html')) {\n        try {\n            const parser = new DOMParser();\n            const doc = parser.parseFromString(body, 'text/html');\n            const header = doc.querySelector('.card-header.bg-danger');\n            const message = header ? header.textContent.trim().replace(/\\s+/g, ' ') : null;\n\n            const codeBlocks = doc.querySelectorAll('pre code');\n            for (const block of codeBlocks) {\n                const lines = block.textContent.split('\\n');\n                const highlightIndex = lines.findIndex((line) => line.trim().startsWith('>>>'));\n                if (highlightIndex !== -1) {\n                    const start = Math.max(0, highlightIndex - 2);\n                    const end = Math.min(lines.length, highlightIndex + 3);\n                    const snippet = lines.slice(start, end).join('\\n').trimEnd();\n                    result.message = message;\n                    result.snippet = snippet;\n                    break;\n                }\n            }\n\n            if (!result.snippet && message) {\n                const fallback = doc.body ? doc.body.textContent : '';\n                const match = fallback ? fallback.match(/>>>[^\\n]*/) : null;\n                if (match) {\n                    result.message = message;\n                    result.snippet = match[0];\n                } else {\n                    result.message = message;\n                }\n            }\n\n            const containsServerFrame = Array.from(doc.querySelectorAll('ol code')).some((codeEl) => {\n                const text = codeEl.textContent || '';\n                return text.includes('<string>');\n            });\n\n            if (!containsServerFrame) {\n                const linkEl = doc.querySelector('ol a[href^=\"/source/\"]');\n                if (linkEl) {\n                    const href = linkEl.getAttribute('href');\n                    if (typeof href === 'string' && href.startsWith('/source/')) {\n                        const label = linkEl.textContent ? linkEl.textContent.trim().replace(/\\s+/g, ' ') : '';\n                        result.sourceLink = {\n                            href,\n                            label: label || href,\n                        };\n                    }\n                }\n            }\n\n            return result;\n        } catch (error) {\n            // Fall back to plain-text handling below.\n        }\n    }\n\n    const snippetMatch = body.match(/>>>[^\\n]*/);\n    const messageLine = body.split('\\n').find((line) => line.trim().length > 0);\n    return {\n        message: messageLine ? messageLine.trim() : undefined,\n        snippet: snippetMatch ? snippetMatch[0] : undefined,\n        sourceLink: undefined,\n    };\n}\n\nfunction _prepareServerTestResult(container) {\n    if (!container) {\n        return;\n    }\n    container.classList.remove('d-none');\n    container.classList.remove('alert-danger', 'alert-success', 'alert-info', 'alert-warning');\n    container.classList.add('alert');\n    container.classList.add('mt-3');\n}\n\nfunction _renderServerTestFailure(container, body, contentType) {\n    if (!container) {\n        return;\n    }\n    _prepareServerTestResult(container);\n    container.classList.add('alert-danger');\n\n    const details = _extractServerTestFailure(body, contentType || '');\n    let html = '<strong>Server test failed.</strong>';\n\n    if (details.message) {\n        html += `<div class=\"mt-2\">${_escapeServerTestHtml(details.message)}</div>`;\n    }\n\n    if (details.snippet) {\n        html += `<pre class=\"mt-3 mb-0\"><code>${_escapeServerTestHtml(details.snippet)}</code></pre>`;\n    }\n\n    if (details.sourceLink && details.sourceLink.href) {\n        const linkLabel = details.sourceLink.label\n            ? _escapeServerTestHtml(details.sourceLink.label)\n            : 'View related source';\n        html += `<div class=\"mt-3\"><a class=\"link-light\" href=\"${details.sourceLink.href}\" target=\"_blank\" rel=\"noopener\">${linkLabel}</a></div>`;\n    }\n\n    container.innerHTML = html;\n}\n\nfunction _renderServerTestNetworkError(container, error) {\n    if (!container) {\n        return;\n    }\n    _prepareServerTestResult(container);\n    container.classList.add('alert-warning');\n    const message = error && error.message ? error.message : 'Network request failed';\n    container.innerHTML = `<strong>Unable to run server test.</strong><div class=\"mt-2\">${_escapeServerTestHtml(message)}</div>`;\n}\n\nif (!window.submitServerTestForm) {\n    window.submitServerTestForm = async function(event) {\n        event.preventDefault();\n\n        const form = event.target;\n        const mode = form.dataset.mode || 'query';\n        const action = form.dataset.action || '/';\n        const params = new URLSearchParams();\n\n        if (mode === 'main') {\n            const inputs = form.querySelectorAll('#server-test-parameters [name]');\n            inputs.forEach((input) => {\n                const value = input.value.trim();\n                if (value !== '') {\n                    params.append(input.name, value);\n                }\n            });\n        } else {\n            const textarea = form.querySelector('#server-test-query');\n            if (textarea) {\n                textarea.value\n                    .split(/\\r?\\n/)\n                    .map((line) => line.trim())\n                    .filter((line) => line.length > 0)\n                    .forEach((line) => {\n                        const parts = line.split('=');\n                        const key = parts.shift();\n                        const value = parts.join('=');\n                        if (key) {\n                            params.append(key.trim(), value.trim());\n                        }\n                    });\n            }\n        }\n\n        const query = params.toString();\n        const url = query ? `${action}?${query}` : action;\n\n        if (typeof window.clearServerTestResult === 'function') {\n            window.clearServerTestResult();\n        }\n\n        const resultContainer = document.getElementById('server-test-result');\n\n        let popup = null;\n        try {\n            popup = window.open('', '_blank');\n        } catch (error) {\n            popup = null;\n        }\n\n        try {\n            const response = await fetch(url, {\n                method: 'GET',\n                headers: {\n                    'X-Requested-With': 'XMLHttpRequest',\n                },\n                credentials: 'same-origin',\n            });\n\n            if (response.ok) {\n                const { absolute: absoluteUrl, display: displayUrl } = _resolveServerTestResultUrl(\n                    response.url || url\n                );\n\n                if (popup) {\n                    if (absoluteUrl) {\n                        try {\n                            popup.location.replace(absoluteUrl);\n                        } catch (error) {\n                            popup.close();\n                        }\n                    } else {\n                        popup.close();\n                    }\n                }\n\n                if (resultContainer) {\n                    _prepareServerTestResult(resultContainer);\n                    resultContainer.classList.add('alert-success');\n                    let html = '<strong>Server test ran successfully.</strong>';\n\n                    if (popup && absoluteUrl) {\n                        html += ' The result opened in a new tab.';\n                    } else if (absoluteUrl) {\n                        const linkId = `server-test-result-link-${Date.now()}`;\n                        html += ` Your browser blocked pop-ups. <a id=\"${linkId}\" href=\"${absoluteUrl}\" target=\"_blank\" rel=\"noopener\">Open the result</a>.`;\n                    } else {\n                        html += ' The result opened, but its URL could not be determined.';\n                    }\n\n                    if (displayUrl) {\n                        html += ` <span class=\"d-block mt-2 small text-muted\">Result path: <code>${_escapeServerTestHtml(displayUrl)}</code></span>`;\n                    }\n\n                    resultContainer.innerHTML = html;\n                }\n\n                return;\n            } else {\n                if (popup) {\n                    popup.close();\n                }\n                const text = await response.text();\n                _renderServerTestFailure(resultContainer, text, response.headers.get('Content-Type'));\n            }\n        } catch (error) {\n            if (popup) {\n                popup.close();\n            }\n            _renderServerTestNetworkError(resultContainer, error);\n        }\n    };\n}\n\nif (!window.uploadServerTestForm) {\n    window.uploadServerTestForm = async function(trigger) {\n        const button = trigger instanceof HTMLElement ? trigger : null;\n        const form = button ? button.closest('form') : null;\n        if (!form) {\n            return;\n        }\n\n        const uploadUrl = form.dataset.uploadUrl;\n        if (!uploadUrl) {\n            return;\n        }\n\n        const values = {};\n        const mode = form.dataset.mode || 'query';\n        if (mode === 'main') {\n            form.querySelectorAll('#server-test-parameters [name]').forEach((input) => {\n                values[input.name] = input.value;\n            });\n        } else {\n            const textarea = form.querySelector('#server-test-query');\n            if (textarea) {\n                values.query = textarea.value;\n            }\n        }\n\n        const resultContainer = document.getElementById('server-test-result');\n        const originalContent = button ? button.innerHTML : '';\n        if (button) {\n            button.disabled = true;\n            button.innerHTML = '<span class=\"spinner-border spinner-border-sm me-1\" role=\"status\" aria-hidden=\"true\"></span>Uploadingâ€¦';\n        }\n\n        try {\n            const response = await fetch(uploadUrl, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest',\n                },\n                credentials: 'same-origin',\n                body: JSON.stringify({ values }),\n            });\n\n            if (!response.ok) {\n                const errorText = await response.text();\n                throw new Error(errorText || 'Unable to upload test page.');\n            }\n\n            const data = await response.json();\n            if (data && data.redirect_url) {\n                window.location.assign(data.redirect_url);\n                return;\n            }\n\n            throw new Error('Upload response did not include a redirect URL.');\n        } catch (error) {\n            if (resultContainer) {\n                _prepareServerTestResult(resultContainer);\n                resultContainer.classList.add('alert-danger');\n                const message = error && error.message ? error.message : 'Unable to upload test page.';\n                resultContainer.innerHTML = `<strong>Unable to upload test page.</strong><div class=\"mt-2\">${_escapeServerTestHtml(message)}</div>`;\n            }\n        } finally {\n            if (button) {\n                button.disabled = false;\n                button.innerHTML = originalContent;\n            }\n        }\n    };\n}\n\nif (!window.resetServerTestForm) {\n    window.resetServerTestForm = function(form) {\n        if (!form) {\n            return;\n        }\n        form.querySelectorAll('input, textarea').forEach((input) => {\n            if (input.name || input.id === 'server-test-query') {\n                input.value = '';\n            }\n        });\n        if (typeof window.clearServerTestResult === 'function') {\n            window.clearServerTestResult();\n        }\n    };\n}\n</script>\n        </div>\n        \n\n        \n\n        \n    </div>\n</div>\n\n<script>\nfunction copyDefinition() {\n    const definition = document.getElementById('server-definition').textContent;\n    navigator.clipboard.writeText(definition).then(function() {\n        const button = event.target.closest('button');\n        const originalContent = button.innerHTML;\n        button.innerHTML = '<i class=\"fas fa-check text-success\"></i> Copied!';\n        setTimeout(() => {\n            button.innerHTML = originalContent;\n        }, 2000);\n    });\n}\n</script>\n\n    </main>\n\n    <!-- Footer -->\n    <footer class=\"bg-dark text-light py-4 mt-5\">\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col-md-6\">\n                    <h5>Viewer</h5>\n                    <p class=\"text-muted\">Secure content management platform</p>\n                </div>\n                <div class=\"col-md-6 text-md-end\">\n                    <span class=\"text-light text-decoration-none\">User management is handled externally.</span>\n                </div>\n            </div>\n            <hr class=\"my-3\">\n            <div class=\"text-center text-muted\">\n                <small>&copy; 2025 Viewer. All rights reserved.</small>\n            </div>\n        </div>\n    </footer>\n\n    <!-- Bootstrap JS -->\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n\n    <script src=\"/static/js/ai_assistant.js\"></script>\n\n    <script>\n    document.addEventListener('click', function (event) {\n        const trigger = event.target.closest('.cid-copy-action');\n        if (!trigger) {\n            return;\n        }\n\n        event.preventDefault();\n\n        const copyPath = trigger.getAttribute('data-copy-path');\n        if (!copyPath) {\n            return;\n        }\n\n        const originalHtml = trigger.innerHTML;\n\n        navigator.clipboard.writeText(`${window.location.origin}${copyPath}`).then(() => {\n            trigger.innerHTML = '<i class=\"fas fa-check text-success me-2\"></i>Copied!';\n            trigger.classList.add('disabled');\n\n            const dropdownToggle = trigger.closest('.dropdown')?.querySelector('[data-bs-toggle=\"dropdown\"]');\n            if (dropdownToggle && window.bootstrap && window.bootstrap.Dropdown) {\n                const dropdownInstance = window.bootstrap.Dropdown.getInstance(dropdownToggle) || new window.bootstrap.Dropdown(dropdownToggle);\n                dropdownInstance.hide();\n            }\n\n            setTimeout(() => {\n                trigger.innerHTML = originalHtml;\n                trigger.classList.remove('disabled');\n            }, 2000);\n        }).catch(() => {\n            trigger.innerHTML = '<i class=\"fas fa-exclamation-triangle text-danger me-2\"></i>Copy failed';\n            setTimeout(() => {\n                trigger.innerHTML = originalHtml;\n            }, 2000);\n        });\n    });\n    </script>\n\n    \n</body>\n</html>"
    }
  },
  "screenshot": {
    "captured": false,
    "placeholder": true,
    "asset": "no-screenshot-available.png",
    "details": [
      "MaxRetryError: HTTPSConnectionPool(host='storage.googleapis.com', port=443): Max retries exceeded with url: /chromium-browser-snapshots/Linux_x64/588429/chrome-linux.zip (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1000)')))"
    ]
  }
}